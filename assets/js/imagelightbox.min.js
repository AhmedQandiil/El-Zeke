!function(M,D,R){"use strict";function o(){var t=R.body||R.documentElement;return""===(t=t.style).transition?"":""===t.WebkitTransition?"-webkit-":""===t.MozTransition?"-moz-":""===t.OTransition&&"-o-"}function z(t,e,i){var n={},a=o();n[a+"transform"]="translateX("+e+") translateY(-50%)",n[a+"transition"]=a+"transform "+i+"s ease-in",t.css(n)}function X(t){if(B)return 1;if(Q&&void 0!==t&&void 0!==t.pointerType)if(void 0!==t.MSPOINTER_TYPE_MOUSE){if(t.MSPOINTER_TYPE_MOUSE!==t.pointerType)return 1}else if("mouse"!==t.pointerType)return 1}var j=M("<div/>").attr("class","imagelightbox-loading").append(M("<div/>")),t=M("<button/>",{type:"button",class:"imagelightbox-arrow imagelightbox-arrow-left"}),e=M("<button/>",{type:"button",class:"imagelightbox-arrow imagelightbox-arrow-right"}),N=t.add(e),U=M("<div/>",{class:"imagelightbox-caption",html:"&nbsp;"}),V=M("<button/>",{type:"button",class:"imagelightbox-close"}),K=M("<div/>",{class:"imagelightbox-overlay"}),Y=M("<a/>",{href:"#",class:"imagelightbox-navitem"}),_=M("<div/>",{class:"imagelightbox-nav"}),H=M("<div/>",{class:"imagelightbox-wrapper"}),W=M("body"),$=!1!==o(),B="ontouchstart"in D,Q=D.navigator.pointerEnabled||D.navigator.msPointerEnabled,A=!!(R.fullscreenEnabled||R.webkitFullscreenEnabled||R.mozFullScreenEnabled||R.msFullscreenEnabled),G=!(!D.history||!history.pushState);M.fn.imageLightbox=function(t){function s(){E.activity&&S(),E.arrows&&N.css("display","block")}function n(t,e,i){var n=e+"="+i,i="?"+n;return t&&(e=new RegExp("([?&])"+e+"=[^&]*"),i=null!==t.match(e)?t.replace(e,"$1"+n):t+"&"+n),i}function i(){var t,e,i;G&&E.history&&(t={imageLightboxIndex:i=(i=p[m].dataset.ilb2Id)||m},(e=p[m].dataset.imagelightbox)&&(t.imageLightboxSet=e),i=n(R.location.search,"imageLightboxIndex",i),e&&(i=n(i,"imageLightboxSet",e)),D.history.pushState(t,"",R.location.pathname+i))}function e(t,e){var i=t;return i&&(t=new RegExp("\\?"+e+"=[^&]*"),e=new RegExp("&"+e+"=[^&]*"),i=(i=i.replace(t,"?")).replace(e,"")),i}function a(t){if((t=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(R.location.search))&&t[2])return decodeURIComponent(t[2].replace(/\+/g," "))}function o(){var t,e;G&&E.history&&((e=a("imageLightboxIndex"))&&(0<(t=p.filter('[data-ilb2-id="'+e+'"]')).length?m=p.index(t):t=M(p[m=e]),e=a("imageLightboxSet"),!t[0]||e&&e!==t[0].dataset.imagelightbox||P(t,!0)))}function u(){if(--m<0){if(!0===E.quitOnEnd)return F(),0;m=p.length-1}f=p.eq(m),i(),H.trigger("previous.ilb2",f),T(1)}function d(){if(++m>=p.length){if(!0===E.quitOnEnd)return F(),0;m=0}i(),f=p.eq(m),H.trigger("next.ilb2",f),T(-1)}function g(){if(!v.length)return!0;var t,e=E.caption?U.outerHeight():0,n=M(D).width(),a=M(D).height()-e,o=Math.abs(1-E.gutter/100);function i(t,e){(n<t||a<e)&&(t/=i=n/a<t/e?t/n:e/a,e/=i);var i=e*o,e=t*o,t=(M(D).width()-e)/2;v.css({width:e+"px",height:i+"px",left:t+"px"})}void 0===v.get(0).videoWidth?((t=new Image).src=v.attr("src"),t.onload=function(){i(t.width,t.height)}):i(v.get(0).videoWidth,v.get(0).videoHeight)}function r(e){e.each(function(){p=e.add(M(this))}),e.on("click.ilb7",{set:h},function(t){t.preventDefault(),h=M(t.currentTarget).data("imagelightbox"),e.filter(function(){return M(this).data("imagelightbox")===h}).filter(function(){return t=M(this),"a"===M(t).prop("tagName").toLowerCase()&&(new RegExp(".("+E.allowedTypes+")$","i").test(M(t).attr("href"))||M(t).data("ilb2Video"));var t}).each(function(){p=p.add(M(this))}),p.length<1?F():P(M(this))})}function l(t){t.each(function(){var t,n,e=M(this).data("ilb2Video");e&&(t=(t=M(this).data("ilb2Id"))||"a"+(65536*(1+Math.random())|0).toString(16),M(this).data("ilb2VideoId",t),n={e:M("<video id='"+E.id+"' preload='metadata'>"),i:t,l:!1,a:void 0},M.each(e,function(t,e){"autoplay"===t?n.a=e:"sources"!==t&&(n.e=n.e.attr(t,e))}),e.sources&&M.each(e.sources,function(t,e){var i=M("<source>");M.each(e,function(t,e){i=i.attr(t,e)}),n.e.append(i)}),n.e.on("loadedmetadata.ilb7",function(){n.l=!0}),b=b.add(n))})}var c,h="",p=M([]),f=M(),b=M([]),m=-1,v=M(),x=0,y=!1,E=M.extend({selector:"a[data-imagelightbox]",id:"imagelightbox",allowedTypes:"png|jpg|jpeg|gif",animationSpeed:250,activity:!1,arrows:!1,button:!1,caption:!1,enableKeyboard:!0,history:!1,fullscreen:!1,gutter:10,offsetY:0,navigation:!1,overlay:!1,preloadNext:!0,quitOnEnd:!1,quitOnImgClick:!1,quitOnDocClick:!0,quitOnEscKey:!0},t),w=function(){H.append(j)},S=function(){M(".imagelightbox-loading").remove()},q=function(){H.append(K)},I=function(){V.appendTo(H).on("click.ilb7",function(){return F(),!1})},k=function(){U.css("opacity","0"),U.html("&nbsp;"),M(f).data("ilb2-caption")?(U.css("opacity","1"),U.html(M(f).data("ilb2-caption"))):M(f).find("img").attr("alt")&&(U.css("opacity","1"),U.html(M(f).find("img").attr("alt")))},O=function(){if(p.length){for(var t=0;t<p.length;t++)_.append(Y.clone());var e=_.children("a");e.eq(p.index(f)).addClass("active"),H.on("previous.ilb2 next.ilb2",function(){e.removeClass("active").eq(p.index(f)).addClass("active")}),H.append(_),_.on("click.ilb7 touchend.ilb7",function(){return!1}).on("click.ilb7 touchend.ilb7","a",function(){var t,e=M(this);p.eq(e.index()).attr("href")===M(".imagelightbox").attr("src")||(t=p.eq(e.index())).length&&(c=p.index(f),f=t,T(e.index()<c?-1:1)),e.addClass("active").siblings().removeClass("active")})}},C=function(){H.append(N),N.on("click.ilb7 touchend.ilb7",function(t){return t.stopImmediatePropagation(),t.preventDefault(),(M(this).hasClass("imagelightbox-arrow-left")?u:d)(),!1})},T=function(c){if(y)return!1;var t;v.length&&(t={opacity:0},$?z(v,100*c-x+"px",E.animationSpeed/1e3):t.left=parseInt(v.css("left"))+100*c+"px",v.animate(t,E.animationSpeed,function(){L()}),x=0),y=!0,E.activity&&w(),E.caption&&k(),setTimeout(function(){var e,t,i,n=f.attr("href"),a=0,o=0,r=f.data("ilb2Video");function l(){var t,e={opacity:1};v.appendTo(H),g(),v.css("opacity",0),$?(z(v,-100*c+"px",0),setTimeout(function(){z(v,"0px",E.animationSpeed/1e3)},50)):(t=parseInt(v.css("left")),e.left=t+"px",v.css("left",t-100*c+"px")),v.animate(e,E.animationSpeed,function(){y=!1,s()}),E.preloadNext&&((e=p.eq(p.index(f)+1)).length||(e=p.eq(0)),M("<img />").attr("src",e.attr("href"))),H.trigger("loaded.ilb2")}r?b.each(function(){this.i===f.data("ilb2VideoId")&&(t=this.l,i=this.e,this.a&&(!1===t&&i.attr("autoplay",this.a),!0===t&&i.get(0).play()))}):i=M("<img id='"+E.id+"' />").attr("src",n),v=i.on("load.ilb7",l).on("error.ilb7",function(){s()}).on("touchstart.ilb7 pointerdown.ilb7 MSPointerDown.ilb7",function(t){return!(X(t.originalEvent)&&!E.quitOnImgClick)||($&&(o=parseInt(v.css("left"))),void(a=t.originalEvent.pageX||t.originalEvent.touches[0].pageX))}).on("touchmove.ilb7 pointermove.ilb7 MSPointerMove.ilb7",function(t){return!((Q||"pointermove"!==t.type)&&X(t.originalEvent)&&!E.quitOnImgClick)||(t.preventDefault(),e=t.originalEvent.pageX||t.originalEvent.touches[0].pageX,x=a-e,void($?z(v,-x+"px",0):v.css("left",o-x+"px")))}).on("touchend.ilb7 touchcancel.ilb7 pointerup.ilb7 pointercancel.ilb7 MSPointerUp.ilb7 MSPointerCancel.ilb7",function(t){return!(X(t.originalEvent)&&!E.quitOnImgClick)||void(50<Math.abs(x)?(x<0?u:d)():$?z(v,"0px",E.animationSpeed/1e3):v.animate({left:o+"px"},E.animationSpeed/2))}),!0===t&&l(),!1===t&&(v=v.on("loadedmetadata.ilb7",l)),r||(v=v.on(Q?"pointerup.ilb7 MSPointerUp.ilb7":"click.ilb7",function(t){if(t.preventDefault(),E.quitOnImgClick)return F(),!1;if(X(t.originalEvent))return!0;var e=(t.pageX||t.originalEvent.pageX)-t.target.offsetLeft;(t.target.width/2>e?u:d)()}))},E.animationSpeed+100)},L=function(){if(!v.length)return!1;v.remove(),v=M()},P=function(t,e){if(y)return!1;y=!1,f=t,m=p.index(f),e||i(),function(){E.arrows&&C(this),E.navigation&&O(),E.overlay&&q(),E.button&&I(),E.caption&&H.append(U)}(),W.append(H).addClass("imagelightbox-open"),H.trigger("start.ilb2",t),T(0)},F=function(t){if(m=-1,t||G&&E.history&&(t=e(R.location.search,"imageLightboxIndex"),t=e(t,"imageLightboxSet"),D.history.pushState({},"",R.location.pathname+t)),H.trigger("quit.ilb2"),W.removeClass("imagelightbox-open"),!v.length)return!1;v.animate({opacity:0},E.animationSpeed,function(){L(),y=!1,H.remove().find("*").remove()})};return M(D).on("resize.ilb7",g),G&&E.history&&M(D).on("popstate",function(t){var e,i,n=t.originalEvent.state;n&&void 0!==(e=n.imageLightboxIndex)?(0<(t=p.filter('[data-ilb2-id="'+e+'"]')).length?i=p.index(t):t=M(p[i=e]),!t[0]||n.imageLightboxSet&&n.imageLightboxSet!==t[0].dataset.imagelightbox||(m<0?P(t,!0):(n=m<i?-1:1,f=t,m=i,T(n)))):F(!0)}),M(R).ready(function(){E.quitOnDocClick&&M(R).on(B?"touchend.ilb7":"click.ilb7",function(t){v.length&&!M(t.target).is(v)&&(t.preventDefault(),F())}),E.fullscreen&&A&&M(R).on("keydown.ilb7",function(t){return!v.length||(-1<[9,32,38,40].indexOf(t.which)&&(t.stopPropagation(),t.preventDefault()),void(-1<[13].indexOf(t.which)&&(t.stopPropagation(),t.preventDefault(),e=D.document,i=R.getElementById(E.id).parentElement,n=i.requestFullscreen||i.mozRequestFullScreen||i.webkitRequestFullScreen||i.msRequestFullscreen,t=e.exitFullscreen||e.mozCancelFullScreen||e.webkitExitFullscreen||e.msExitFullscreen,e.fullscreenElement||e.mozFullScreenElement||e.webkitFullscreenElement||e.msFullscreenElement?t.call(e):n.call(i))));var e,i,n}),E.enableKeyboard&&M(R).on("keydown.ilb7",function(t){return!v.length||(-1<[27].indexOf(t.which)&&E.quitOnEscKey&&(t.stopPropagation(),t.preventDefault(),F()),-1<[37].indexOf(t.which)&&(t.stopPropagation(),t.preventDefault(),u()),void(-1<[39].indexOf(t.which)&&(t.stopPropagation(),t.preventDefault(),d())))})}),M(R).off("click",E.selector),r(M(this)),o(),l(p),this.addToImageLightbox=function(t){r(t),l(t)},this.openHistory=function(){o()},this.loadPreviousImage=function(){u()},this.loadNextImage=function(){d()},this.quitImageLightbox=function(){return F(),this},this.startImageLightbox=function(t){(t||M(this)).trigger("click.ilb7")},this}}("object"==typeof module&&"object"==typeof module.exports?require("jquery"):jQuery,window,document);